// Copyright 2021 Contributors to the Veraison project.
// SPDX-License-Identifier: Apache-2.0

package cmd

import "github.com/veraison/corim/comid"

var (
	minimalCorimTemplate = []byte(`{
		"corim-id": "5c57e8f4-46cd-421b-91c9-08cf93e13cfc"
	}`)
	badCBOR = comid.MustHexDecode(nil, "ffff")
	// a "tag-id only" CoMID {1: {0: h'366D0A0A598845ED84882F2A544F6242'}}
	invalidComid = comid.MustHexDecode(nil,
		"a101a10050366d0a0a598845ed84882f2a544f6242",
	)
	// note: embedded CoSWIDs are not validated {0: h'5C57E8F446CD421B91C908CF93E13CFC', 1: [505(h'deadbeef')]}
	testCorimValid = comid.MustHexDecode(nil,
		"a200505c57e8f446cd421b91c908cf93e13cfc0181d901f944deadbeef",
	)
	// {0: h'5C57E8F446CD421B91C908CF93E13CFC'}
	testCorimInvalid = comid.MustHexDecode(nil,
		"a100505c57e8f446cd421b91c908cf93e13cfc",
	)
	testMetaInvalid = []byte("{}")
	testMetaValid   = []byte(`{
		"signer": {
			"name": "ACME Ltd signing key",
			"uri": "https://acme.example"
		},
		"validity": {
			"not-before": "2021-12-31T00:00:00Z",
			"not-after": "2025-12-31T00:00:00Z"
		}
	}`)
	testECKey = []byte(`{
		"kty": "EC",
		"crv": "P-256",
		"x": "MKBCTNIcKUSDii11ySs3526iDZ8AiTo7Tu6KPAqv7D4",
		"y": "4Etl6SRW2YiLUrN5vfvVHuhp7x8PxltmWWlbbM4IFyM",
		"d": "870MB6gfuTJ4HtUnUvYMyJpr5eUZNP4Bk43bVdj3eAE",
		"use": "enc",
		"kid": "1"
	  }`)

	testSignedCorimValid = comid.MustHexDecode(nil, `
	d284585da3012603746170706c69636174696f6e2f72696d2b63626f7208
	5841a200a2007441434d45204c7464207369676e696e67206b657901d820
	7468747470733a2f2f61636d652e6578616d706c6501a200c11a61ce4800
	01c11a69546780a0590282a600505c57e8f446cd421b91c908cf93e13cfc
	01815901a3d901faa40065656e2d474201a1005043bbe37f2e614b33aed3
	53cff1428b160281a3006941434d45204c74642e01d8207468747470733a
	2f2f61636d652e6578616d706c65028300010204a1008182a100a300d902
	58582061636d652d696d706c656d656e746174696f6e2d69642d30303030
	3030303031016441434d45026a526f616452756e6e657283a200d90259a3
	0162424c0465322e312e30055820acbb11c7e4da217205523ce4ce1a245a
	e1a239ae3c6bfd9e7871f7e5d8bae86b01a102818201582087428fc52280
	3d31065e7bce3cf03fe475096631e5e07bbd7a0fde60c4cf25c7a200d902
	59a3016450526f540465312e332e35055820acbb11c7e4da217205523ce4
	ce1a245ae1a239ae3c6bfd9e7871f7e5d8bae86b01a10281820158200263
	829989b6fd954f72baaf2fc64bc2e2f01d692d4de72986ea808f6e99813f
	a200d90259a3016441526f540465302e312e34055820acbb11c7e4da2172
	05523ce4ce1a245ae1a239ae3c6bfd9e7871f7e5d8bae86b01a102818201
	5820a3a5e715f0cc574a73c3f9bebb6bc24f32ffd5b67b387244c2c909da
	779a14780281a200d820784068747470733a2f2f706172656e742e657861
	6d706c652f72696d732f63636233616138352d363162342d343066312d38
	3438652d3032616436653861323534620182015820e45b72f5c0c0b572db
	4d8d3ab7e97f368ff74e62347a824decb67a84e5224d750382482b060104
	01a02064781c687474703a2f2f61726d2e636f6d2f696f742f70726f6669
	6c652f3104a200c11a61ce480001c11a695467800581a3006941434d4520
	4c74642e01d8206c61636d652e6578616d706c6502810158400f79b7a7de
	b0480ed9c5b8b29aaffef33b1094f4e11409dbbbc4c1c2abf79fda30d72e
	b86d19053dc5caada1abe76f1e13cad3bef27eebc09086463fe02f5ac4	
	`)
	testSignedCorimInvalid = comid.MustHexDecode(nil, `
d284585da3012603746170706c69636174696f6e2f72696d2b63626f7208
5841a200a2007441434d45204c7464207369676e696e67206b657901d820
7468747470733a2f2f61636d652e6578616d706c6501a200c11a61ce4800
01c11a69546780a041a044deadbeef
	`)
	PSARefValCBOR = comid.MustHexDecode(nil, `
a40065656e2d474201a1005043bbe37f2e614b33aed353cff1428b160281
a3006941434d45204c74642e01d8207468747470733a2f2f61636d652e65
78616d706c65028300010204a1008182a100a300d90258582061636d652d
696d706c656d656e746174696f6e2d69642d303030303030303031016441
434d45026a526f616452756e6e657283a200d90259a30162424c0465322e
312e30055820acbb11c7e4da217205523ce4ce1a245ae1a239ae3c6bfd9e
7871f7e5d8bae86b01a102818201582087428fc522803d31065e7bce3cf0
3fe475096631e5e07bbd7a0fde60c4cf25c7a200d90259a3016450526f54
0465312e332e35055820acbb11c7e4da217205523ce4ce1a245ae1a239ae
3c6bfd9e7871f7e5d8bae86b01a10281820158200263829989b6fd954f72
baaf2fc64bc2e2f01d692d4de72986ea808f6e99813fa200d90259a30164
41526f540465302e312e34055820acbb11c7e4da217205523ce4ce1a245a
e1a239ae3c6bfd9e7871f7e5d8bae86b01a1028182015820a3a5e715f0cc
574a73c3f9bebb6bc24f32ffd5b67b387244c2c909da779a1478
	`)
	testComid = comid.MustHexDecode(nil, `
a40065656e2d474201a1005043bbe37f2e614b33aed353cff1428b160281
a3006941434d45204c74642e01d8207468747470733a2f2f61636d652e65
78616d706c65028300010204a1008182a100a300d90258582061636d652d
696d706c656d656e746174696f6e2d69642d303030303030303031016441
434d45026a526f616452756e6e657283a200d90259a30162424c0465322e
312e30055820acbb11c7e4da217205523ce4ce1a245ae1a239ae3c6bfd9e
7871f7e5d8bae86b01a102818201582087428fc522803d31065e7bce3cf0
3fe475096631e5e07bbd7a0fde60c4cf25c7a200d90259a3016450526f54
0465312e332e35055820acbb11c7e4da217205523ce4ce1a245ae1a239ae
3c6bfd9e7871f7e5d8bae86b01a10281820158200263829989b6fd954f72
baaf2fc64bc2e2f01d692d4de72986ea808f6e99813fa200d90259a30164
41526f540465302e312e34055820acbb11c7e4da217205523ce4ce1a245a
e1a239ae3c6bfd9e7871f7e5d8bae86b01a1028182015820a3a5e715f0cc
574a73c3f9bebb6bc24f32ffd5b67b387244c2c909da779a1478
	`)
	testCoswid = comid.MustHexDecode(nil, `
a8007820636f6d2e61636d652e727264323031332d63652d7370312d7634
2d312d352d300c0001783041434d4520526f616472756e6e657220446574
6563746f72203230313320436f796f74652045646974696f6e205350310d
65342e312e3505a5182b65747269616c182d6432303133182f66636f796f
7465183473526f616472756e6e6572204465746563746f72183663737031
0282a3181f745468652041434d4520436f72706f726174696f6e18206861
636d652e636f6d1821820102a3181f75436f796f74652053657276696365
732c20496e632e18206c6d79636f796f74652e636f6d18210404a2182678
1c7777772e676e752e6f72672f6c6963656e7365732f67706c2e74787418
28676c6963656e736506a110a318186a72726465746563746f7218196d25
70726f6772616d6461746125181aa111a318186e72726465746563746f72
2e657865141a000820e80782015820a314fc2dc663ae7a6b6bc678759405
7396e6b3f569cd50fd5ddb4d1bbafd2b6a
	`)
)
